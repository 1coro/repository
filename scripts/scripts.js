"use strict";angular.module("ui.bootstrap",["ui.bootstrap.transition","ui.bootstrap.collapse"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(a,b,c){function d(a){for(var b in a)if(void 0!==f.style[b])return a[b]}var e=function(d,f,g){g=g||{};var h=a.defer(),i=e[g.animation?"animationEndEventName":"transitionEndEventName"],j=function(){c.$apply(function(){d.unbind(i,j),h.resolve(d)})};return i&&d.bind(i,j),b(function(){angular.isString(f)?d.addClass(f):angular.isFunction(f)?f(d):angular.isObject(f)&&d.css(f),i||h.resolve(d)}),h.promise.cancel=function(){i&&d.unbind(i,j),h.reject("Transition cancelled")},h.promise},f=document.createElement("trans"),g={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},h={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return e.transitionEndEventName=d(g),e.animationEndEventName=d(h),e}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(a){return{link:function(b,c,d){function e(b){function d(){j===e&&(j=void 0)}var e=a(c,b);return j&&j.cancel(),j=e,e.then(d,d),e}function f(){k?(k=!1,g()):(c.removeClass("collapse").addClass("collapsing"),e({height:c[0].scrollHeight+"px"}).then(g))}function g(){c.removeClass("collapsing"),c.addClass("collapse in"),c.css({height:"auto"})}function h(){k?(k=!1,i(),c.css({height:0})):(c.css({height:c[0].scrollHeight+"px"}),c[0].offsetWidth,c.removeClass("collapse in").addClass("collapsing"),e({height:0}).then(i))}function i(){c.removeClass("collapsing"),c.addClass("collapse")}var j,k=!0;b.$watch(d.collapse,function(a){a?h():f()})}}}]),angular.module("kodiAddonBrowserApp",["ui.router","cb.x2js","ui.bootstrap"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/addons"),a.state("addons",{url:"/addons",templateUrl:"views/main.html",controller:"MainCtrl"}).state("addons.detail",{url:"^/:id",views:{detail:{templateUrl:"views/detail.html",controller:"DetailCtrl"}}})}]),angular.module("kodiAddonBrowserApp").controller("MainCtrl",["$scope","KodiAddonService","$state",function(a,b,c){a.$state=c,a.addonXml="repo/addons.xml",a.repoUrl="repo",a.addonFilter,b.getAddons(a.addonXml,a.repoUrl).then(function(b){a.addons=b,console.log(b)})}]).controller("DetailCtrl",["$scope","KodiAddonService","$stateParams",function(a,b,c){a.addonXml="repo/addons.xml",a.repoUrl="repo",b.getAddons(a.addonXml,a.repoUrl).then(function(){b.getAddon(c.id).then(function(c){a.addon=c,b.getChangelog(c).then(function(a){$("#changelog").html(a)})})})}]),angular.module("kodiAddonBrowserApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("kodiAddonBrowserApp").factory("KodiAddonService",["$http","$q","x2js","$filter",function(a,b,c,d){var e;return{getChangelog:function(c){var d=b.defer();return a.get(c.changelog).success(function(a){a=a.replace(/\[[Bb]\]/g,"<strong>").replace(/\[\/[Bb]\]/g,"</strong>"),d.resolve(a)}),d.promise},getAddon:function(a){var c=b.defer(),f=d("filter")(e,{_id:a});return f&&f.length>0?c.resolve(f[0]):c.reject("No such addon with id "+a),c.promise},getAddons:function(d,f){var g=b.defer();return angular.isDefined(e)?(g.resolve(e),g.promise):("/"!==f[f.length-1]&&(f+="/"),a.get(d).success(function(a){var b={"2.1.0":["Frodo 12.x","Gotham 13.x","Kodi 14.x"],"2.14.0":["Gotham 13.x","Kodi 14.x"],"2.19.0":["Kodi 14.x"]},d={video:"film",audio:"music"},h=function(a){var b={};return angular.forEach(a,function(a){b[a._lang]=a.__text}),b},i=c.xml_str2json(a),j={};angular.forEach(i.addons.addon,function(a){j[a._id]=a}),angular.forEach(i.addons.addon,function(a){a.changelog=f+a._id+"/changelog-"+a._version+".txt",a.zip=f+a._id+"/"+a._id+"-"+a._version+".zip",a.icon=f+a._id+"/icon.png",a.depends=[],a.provides=[],angular.forEach(a.extension,function(b){"xbmc.addon.metadata"===b._point&&(a.description=h(b.description),a.summary=h(b.summary),a.source=b.source,a.website=b.website,a.email=b.email,angular.isDefined(b.broken)&&(a.broken=b.broken)),"xbmc.python.pluginsource"==b._point&&("string"==typeof b.provides?a.provides.push({name:b.provides,img:d[b.provides]}):angular.forEach(b.provides,function(b){a.provides.push({name:b,img:d[b]})})),"xbmc.subtitle.module"==b._point&&a.provides.push({name:"Titulky",img:"subtitles"}),"xbmc.addon.repository"==b._point&&a.provides.push({name:"Repository",img:"list"})}),angular.isDefined(a.requires)&&angular.forEach(a.requires.import,function(c){angular.isDefined(j[c._addon])&&a.depends.push({addon:c._addon,version:c._version,name:j[c._addon]._name}),"xbmc.python"==c._addon&&(a.requireKodi=b[c._version])})}),e=i.addons.addon,g.resolve(i.addons.addon)}).error(function(a){g.reject(a)}),g.promise)}}}]),angular.module("kodiAddonBrowserApp").directive("kodiAddonList",function(){return{restrict:"E",scope:{addonXml:"@",repoUrl:"@",addons:"="},templateUrl:"views/addon-list.html",controller:["$scope","KodiAddonService",function(a,b){b.getAddons(a.addonXml,a.repoUrl).then(function(b){a.addons=b,console.log(b)})}],link:function(){}}});